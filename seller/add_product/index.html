<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Products Dashboard</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <!-- main css -->
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar">
        <h3><i class="fa-brands fa-apple"></i> <br>lol Store</h3>
        <ul class="text-center">
        <li><a href="../dash/dash.html"><i class="fa fa-home"></i>Dashboard</a></li>
        <li><a href="../add_product/index.html"><i class="fa fa-box"></i> Products</a></li>
        <li><a href="../order/order.html"><i class="fa fa-users"></i> Orders</a></li>
        <li><a href="../porfile/prof.html"><i class="fa-solid fa-user-tie"></i> Profile</a></li>
        </ul>
    </aside>

  <!-- Main Content -->
  <main id="mainContent" class="main-content">
      
    <!-- Navbar -->
    <nav class="navbar navbar-custom navbar-light mb-4">
      <div class="container-fluid d-flex align-items-center justify-content-between">
        <button class="btn btn-outline-secondary" id="toggleSidebarBtn">
          <i id="toggleIcon" class="fa fa-bars"></i>
        </button>
        <span class="navbar-brand mb-0 h1 text-center">Admin Panel</span>
      </div>
    </nav>
    <!-- add product -->
<section class="add">
  <div class="head d-flex justify-content-between align-items-center flex-wrap">
    <h2>Products</h2>
    <form id="searchForm" class="d-flex justify-content-between align-items-center m-3 flex-start" role="search">
      <input id="searchInput" class="form-control me-2 m-1" type="search" placeholder="Search about Product" aria-label="Search" />
      <button class="btn btn-outline-dark m-1" type="submit">Search</button>
      <button class="btn btn-primary m-1" type="button" id="addProduct">+ Add</button>
    </form>
  </div>
<!-- table -->
  <div class="table-responsive mt-3 shadow-sm rounded">
    <table class="table table-striped align-middle table-bordered" id="productTable">
      <thead class="table-dark">
        <tr>
          <th>#ID</th>
          <th>Product Name</th>
          <th>Created At</th>
          <th>Category</th>
          <th>Quantity</th>
          <th>Status</th>
          <th>Price</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>

      </tbody>
    </table>
  </div>
  
</section>
  </main>



  <!-- <div class="head d-flex justify-content-between align-items-center flex-wrap">
    <h2>Products</h2>
    <form id="searchForm" class="d-flex justify-content-between align-items-center m-3 flex-start" role="search">
      <input id="searchInput" class="form-control me-2 m-1" type="search" placeholder="Search about Product" aria-label="Search" />
      <button class="btn btn-outline-dark m-1" type="submit">Search</button>
      <button class="btn btn-primary m-1" type="button" id="addProduct">+ Add</button>
    </form>
  </div>

  <div class="table-responsive mt-3 shadow-sm rounded">
    <table class="table table-striped align-middle table-bordered" id="productTable">
      <thead class="table-dark">
        <tr>
          <th>#ID</th>
          <th>Product Name</th>
          <th>Created At</th>
          <th>Category</th>
          <th>Quantity</th>
          <th>Status</th>
          <th>Price</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div> -->
  <script src="../dash.js"></script>
  <script>
    const tableBody = document.querySelector("#productTable tbody");

    // Load products from localStorage
    function loadProducts() {
      const products = JSON.parse(localStorage.getItem("products")) || [];
      tableBody.innerHTML = "";

      products.forEach((product, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${product.name}</td>
          <td>${product.createdAt}</td>
          <td>${product.category}</td>
          <td>${product.quantity}</td>
          <td><span class="badge ${
            product.status === "Active"
              ? "bg-success"
              : product.status === "Pending"
              ? "bg-warning"
              : "bg-secondary"
          }">${product.status}</span></td>
          <td>$${product.price}</td>
          <td>
            <button class="btn btn-sm btn-outline-success edit" data-index="${index}">
              <i class="fa fa-edit"></i>
            </button>
            <button class="btn btn-sm btn-outline-danger delete" data-index="${index}">
              <i class="fa fa-trash"></i>
            </button>
          </td>
        `;
        tableBody.appendChild(row);
      });

      attachEvents();
    }

    function attachEvents() {
      // 🗑️ Delete product
      const deleteBtns = document.querySelectorAll(".delete");
      deleteBtns.forEach((btn) => {
        btn.onclick = () => {
          const index = btn.dataset.index;
          const products = JSON.parse(localStorage.getItem("products")) || [];
          products.splice(index, 1);
          localStorage.setItem("products", JSON.stringify(products));
          loadProducts();
        };
      });

      // ✏️ Edit product
      const editBtns = document.querySelectorAll(".edit");
      editBtns.forEach((btn) => {
        btn.onclick = () => {
          const index = btn.dataset.index;
          window.location.href = `add-product.html?edit=${index}`;
        };
      });
    }

    // Search functionality
    const searchForm = document.getElementById("searchForm");
    const searchInput = document.getElementById("searchInput");

    searchForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const term = searchInput.value.toLowerCase();
      const rows = tableBody.getElementsByTagName("tr");
      Array.from(rows).forEach((row) => {
        const text = row.innerText.toLowerCase();
        row.style.display = text.includes(term) ? "" : "none";
      });
    });

    // ➕ Go to Add Page
    document.getElementById("addProduct").addEventListener("click", () => {
      window.location.href = "add-product.html";
    });

    // Load on start
    loadProducts();
  </script>
</body>
</html>
